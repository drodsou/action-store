function f(s={}){let o=new Set;function n(t,r){for(let a of o)a({state:e.state,computed:e.computed,actionName:t,actionArgs:r})}let e={_subs:o,_runSubs:n,state:s,computed:{},action:new Proxy({},{get(t,r){return function(...a){t[r].apply(e,a),n(r,a)}}}),subscribe(t,r=!0){return o.add(t),r&&t({state:e.state,computed:e.computed}),()=>o.delete(t)}};return e}function u(s,o=document,n=[]){for(let e of o.querySelectorAll("*"))e.hasAttribute(s)&&n.push(e),e.shadowRoot&&u(s,e.shadowRoot,n);return n}function l(s){let o="s-data";for(let n of u(o))for(let e of n.attributes[o].value.split(";")){let[t,r,...a]=e.trim().split(":");if(!t)continue;let c=new Function("e","data","args",r.includes("state.")?`e.${t} = data.${r}`:`e.${t} = data.${r}(...args)`);try{c(n,s,a)}catch(i){console.error(`ERROR: Not found ${o}: ${t}:${r}`),console.log(i)}}}function p(s){let o="s-action";if(!s)throw new Error("A 'store' parameter is needed");for(let n of u(o))for(let e of n.attributes[o].value.split(";")){let[t,r,...a]=e.trim().split(":");if(!!t)try{n.addEventListener(t,()=>s.action[r](...a))}catch{console.error(`ERROR: ${o}: ${t}:${r}:${a}`)}}}export{p as addEventListenerSAction,f as createStore,l as subscribeSData};
